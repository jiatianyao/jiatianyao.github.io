<!doctype html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="人生在勤 勤则不匮">
<meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://yoursite.com/page/3/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="人生在勤 勤则不匮">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hexo">
<meta name="twitter:description" content="人生在勤 勤则不匮">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/3/"/>





  <title> Hexo </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?7429985a9690d626019a4aae76bf7702";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>








  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Hexo</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-kafka " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/12/02/codis 集群/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="张洪铭">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Hexo">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Hexo" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/12/02/codis 集群/" itemprop="url">
                  codis 集群
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-12-02T23:33:30+08:00">
                2016-12-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/大数据/" itemprop="url" rel="index">
                    <span itemprop="name">大数据</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2016/12/02/codis 集群/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/12/02/codis 集群/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>安装go语言<br><a href="http://www.golangtc.com/download" target="_blank" rel="external">http://www.golangtc.com/download</a></p>
<p>选择1.7.3下载<br><img src="http://oh6ybr0jg.bkt.clouddn.com/go1.7.3.jpg" alt="go1.7.3"><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">tar -zxvf go1<span class="number">.7</span><span class="number">.3</span>.linux-amd64.tar.gz -C /usr/local/</div></pre></td></tr></table></figure></p>
<p>下载jdk和zookeeper并解压</p>
<p>配置zookeeper</p>
<p>创建文件夹 zkData和zkLog<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">cp zoo_sample.cfg zoo.cfg</div><div class="line"></div><div class="line">vi zoo.cfg </div><div class="line">dataDir=<span class="regexp">/root/</span>zookeeper/zookeeper<span class="number">-3.4</span><span class="number">.6</span>/zkData</div><div class="line">dataLogDir=<span class="regexp">/usr/</span>bigdata/zookeeper<span class="number">-3.4</span><span class="number">.6</span>/zkLog</div><div class="line">server<span class="number">.1</span>=master:<span class="number">2888</span>:<span class="number">3888</span></div></pre></td></tr></table></figure></p>
<p>进入zkData<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">echo <span class="number">1</span> &gt; myid</div></pre></td></tr></table></figure></p>
<p>– 配置环境变量<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> JAVA_HOME=<span class="regexp">/root/</span>java/jdk1<span class="number">.8</span><span class="number">.0</span>_111</div><div class="line"><span class="keyword">export</span> GOROOT=<span class="regexp">/usr/</span>local/go</div><div class="line"><span class="keyword">export</span> GOPATH=<span class="regexp">/usr/</span>local/codis</div><div class="line"><span class="keyword">export</span> ZOOKEEPER_HOME=<span class="regexp">/root/</span>zookeeper/zookeeper<span class="number">-3.4</span><span class="number">.6</span></div><div class="line"><span class="keyword">export</span> PATH=$PATH:$JAVA_HOME/bin:$GOROOT/bin:$GOPATH/bin:$ZOOKEEPER_HOME/bin</div></pre></td></tr></table></figure></p>
<p>下载codis<br><a href="https://github.com/CodisLabs/codis/releases" target="_blank" rel="external">https://github.com/CodisLabs/codis/releases</a><br>选择与go版本一样的codis版本<br><img src="http://oh6ybr0jg.bkt.clouddn.com/codis3.1.0-go1.7.3.png" alt="codis3.1.0-go1.7.1"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">mkdir -p $GOPATH/src/github.com/CodisLabs</div><div class="line">tar -xzf codis<span class="number">-3.1</span><span class="number">.0</span>.tar.gz -C /usr/local/codis/src/github.com/CodisLabs/</div><div class="line">cd /usr/local/codis/src/github.com/CodisLabs/</div><div class="line">mv codis<span class="number">-3.1</span><span class="number">.0</span>/ codis</div><div class="line">cd codis/</div><div class="line">make</div></pre></td></tr></table></figure>
<p><img src="http://oh6ybr0jg.bkt.clouddn.com/codis_make.jpg" alt="codis_make"><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">make gotest</div></pre></td></tr></table></figure></p>
<p><img src="http://oh6ybr0jg.bkt.clouddn.com/codis_gotest.jpg" alt="codis_gotest"></p>
<p>执行成功后进入bin 目录<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cd /usr/local/codis/src/github.com/CodisLabs/codis/bin</div></pre></td></tr></table></figure></p>
<p><img src="http://oh6ybr0jg.bkt.clouddn.com/codis-bin.jpg" alt="codis-bin"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">mkdir /etc/codis</div><div class="line">cd /usr/local/codis/src/github.com/CodisLabs/codis/extern</div><div class="line">cp redis<span class="number">-2.8</span><span class="number">.21</span>/redis.conf /etc/codis/redis6379.conf</div></pre></td></tr></table></figure>
<p>创建redis 配置文件中所指定的目录<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">[root@zhm1 codis]# cd /opt</div><div class="line">[root@zhm1 opt]# mkdir -p codisapp/run</div><div class="line">[root@zhm1 opt]# mkdir -p codisapp/logs</div><div class="line">[root@zhm1 opt]# mkdir -p codisapp/data/6379 codisapp/data/6380</div><div class="line">[root@zhm1 opt]# </div><div class="line"></div><div class="line">vi /etc/codis/redis6379.conf</div><div class="line"></div><div class="line">daemonize yes</div><div class="line">pidfile /opt/codisapp/run/redis6379.pid</div><div class="line">port 6379</div><div class="line">logfile "/opt/codisapp/logs/redis6379.log"</div><div class="line">dbfilename dump.rdb</div><div class="line">dir /opt/codisapp/data/6379</div><div class="line"></div><div class="line">cp /etc/codis/redis6379.conf /etc/codis/redis6380.conf</div><div class="line">vi /etc/codis/redis6380.conf</div><div class="line"></div><div class="line">daemonize yes</div><div class="line">pidfile /opt/codisapp/run/redis6380.pid</div><div class="line">port 6380</div><div class="line">logfile "/opt/codisapp/logs/redis6380.log"</div><div class="line">dbfilename dump.rdb</div><div class="line">dir /opt/codisapp/data/6380</div></pre></td></tr></table></figure></p>
<p>启动redis<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[root@zhm1 opt]# cd /usr/local/codis/src/github.com/CodisLabs/codis/</div><div class="line">[root@zhm1 codis]# ./bin/codis-server /etc/codis/redis6379.conf --protected-mode no </div><div class="line">[root@zhm1 codis]# ./bin/codis-server /etc/codis/redis6380.conf --protected-mode no</div></pre></td></tr></table></figure></p>
<p>此处启动增加–protected-mode no  参数可以防止后面添加server的时候提示<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Cause<span class="string">": "</span>DENIED Redis is running <span class="keyword">in</span> protected mode because protected mode is enabled, no bind address was specified, no authentication password is requested to clients. In <span class="keyword">this</span> mode connections are only accepted <span class="keyword">from</span> the loopback interface. If you want to connect <span class="keyword">from</span> external computers to Redis you may adopt one <span class="keyword">of</span> the following solutions: <span class="number">1</span>) Just disable protected mode sending the command <span class="string">'CONFIG SET protected-mode no'</span> <span class="keyword">from</span> the loopback interface by connecting to Redis <span class="keyword">from</span> the same host the server is running, however MAKE SURE Redis is not publicly accessible <span class="keyword">from</span> internet <span class="keyword">if</span> you <span class="keyword">do</span> so. Use CONFIG REWRITE to make <span class="keyword">this</span> change permanent. <span class="number">2</span>) Alternatively you can just disable the protected mode by editing the Redis configuration file, and setting the protected mode option to <span class="string">'no'</span>, and then restarting the server. <span class="number">3</span>) If you started the server manually just <span class="keyword">for</span> testing, restart it <span class="keyword">with</span> the <span class="string">'--protected-mode no'</span> option. <span class="number">4</span>) Setup a bind address or an authentication password. NOTE: You only need to <span class="keyword">do</span> one <span class="keyword">of</span> the above things <span class="keyword">in</span> order <span class="keyword">for</span> the server to start accepting connections <span class="keyword">from</span> the outside.</div></pre></td></tr></table></figure></p>
<p>启动dashboard<br>自定义dashboard 配置文件<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./bin/codis-dashboard --<span class="keyword">default</span>-config | tee dashboard.conf</div></pre></td></tr></table></figure></p>
<p><img src="http://oh6ybr0jg.bkt.clouddn.com/codis-dashboard.jpg" alt="codis-dashboard"></p>
<p>修改IP<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">[root@zhm1 codis]# vi dashboard.conf </div><div class="line">##################################################</div><div class="line">#                                                #</div><div class="line">#                  Codis-Dashboard               #</div><div class="line">#                                                #</div><div class="line">##################################################</div><div class="line"></div><div class="line"># Set Coordinator, only accept "zookeeper" &amp; "etcd".</div><div class="line">coordinator_name = "zookeeper"</div><div class="line">coordinator_addr = "192.168.110.129:2181"</div><div class="line"></div><div class="line"># Set Codis Product Name/Auth.</div><div class="line">product_name = "codis-demo"</div><div class="line">product_auth = ""</div><div class="line"></div><div class="line"># Set bind address for admin(rpc), tcp only.</div><div class="line">admin_addr = "192.168.110.129:18080"</div><div class="line"></div><div class="line"># Set quorum value for sentinel, default is 2.</div><div class="line">sentinel_quorum = 2</div></pre></td></tr></table></figure></p>
<p>启动zookeeper<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[root@zhm1 codis]# zkServer.sh start</div><div class="line">JMX enabled by default</div><div class="line">Using config: /root/zookeeper/zookeeper-3.4.6/bin/../conf/zoo.cfg</div><div class="line">Starting zookeeper ... STARTED</div></pre></td></tr></table></figure></p>
<p>启动dashboard<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[root@zhm1 codis]# nohup bin/codis-dashboard --ncpu=2 --config=dashboard.conf --log=dashboard.log --log-level=WARN &amp;</div></pre></td></tr></table></figure></p>
<p>查看日志输出，连接zookeeper 成功<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">[root@zhm1 codis]# cat dashboard.log.2016-12-21</div><div class="line">2016/12/21 11:18:34 main.go:77: [WARN] set ncpu = 2</div><div class="line">2016/12/21 11:18:34 topom.go:110: [WARN] create new topom:</div><div class="line">&#123;</div><div class="line">    "token": "6047b5ce9ef2826c1eb40692023b9bf4",</div><div class="line">    "start_time": "2016-12-21 11:18:34.481106135 +0800 CST",</div><div class="line">    "admin_addr": "192.168.110.129:18080",</div><div class="line">    "product_name": "codis-demo",</div><div class="line">    "pid": 66994,</div><div class="line">    "pwd": "/usr/local/codis/src/github.com/CodisLabs/codis",</div><div class="line">    "sys": "Linux zhm1.cn 3.10.0-514.el7.x86_64 #1 SMP Tue Nov 22 16:42:41 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux"</div><div class="line">&#125;</div><div class="line">2016/12/21 11:18:35 main.go:124: [WARN] create topom with config</div><div class="line">coordinator_name = "zookeeper"</div><div class="line">coordinator_addr = "192.168.110.129:2181"</div><div class="line">admin_addr = "192.168.110.129:18080"</div><div class="line">product_name = "codis-demo"</div><div class="line">product_auth = ""</div><div class="line">sentinel_quorum = 2</div><div class="line">2016/12/21 11:18:36 topom.go:381: [WARN] admin start service on 192.168.110.129:18080</div></pre></td></tr></table></figure></p>
<p>启动codis-proxy<br>编译codis-proxy 配置文件<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div></pre></td><td class="code"><pre><div class="line">[root@zhm1 codis]# ./bin/codis-proxy --default-config | tee proxy.conf</div><div class="line"></div><div class="line">##################################################</div><div class="line">#                                                #</div><div class="line">#                  Codis-Proxy                   #</div><div class="line">#                                                #</div><div class="line">##################################################</div><div class="line"></div><div class="line"># Set Codis Product Name/Auth.</div><div class="line">product_name = "codis-demo"</div><div class="line">product_auth = ""</div><div class="line"></div><div class="line"># Set bind address for admin(rpc), tcp only.</div><div class="line">admin_addr = "0.0.0.0:11080"</div><div class="line"></div><div class="line"># Set bind address for proxy, proto_type can be "tcp", "tcp4", "tcp6", "unix" or "unixpacket".</div><div class="line">proto_type = "tcp4"</div><div class="line">proxy_addr = "0.0.0.0:19000"</div><div class="line"></div><div class="line"># Set jodis address &amp; session timeout, only accept "zookeeper" &amp; "etcd".</div><div class="line">jodis_name = ""</div><div class="line">jodis_addr = ""</div><div class="line">jodis_timeout = "20s"</div><div class="line">jodis_compatible = false</div><div class="line"></div><div class="line"># Set datacenter of proxy.</div><div class="line">proxy_datacenter = ""</div><div class="line"></div><div class="line"># Set max number of alive sessions.</div><div class="line">proxy_max_clients = 1000</div><div class="line"></div><div class="line"># Set max offheap memory size. (0 to disable)</div><div class="line">proxy_max_offheap_size = "1024mb"</div><div class="line"></div><div class="line"># Set heap placeholder to reduce GC frequency.</div><div class="line">proxy_heap_placeholder = "256mb"</div><div class="line"></div><div class="line"># Proxy will ping backend redis in a predefined interval. (0 to disable)</div><div class="line">backend_ping_period = "5s"</div><div class="line"></div><div class="line"># Set backend recv buffer size &amp; timeout.</div><div class="line">backend_recv_bufsize = "128kb"</div><div class="line">backend_recv_timeout = "30s"</div><div class="line"></div><div class="line"># Set backend send buffer &amp; timeout.</div><div class="line">backend_send_bufsize = "128kb"</div><div class="line">backend_send_timeout = "30s"</div><div class="line"></div><div class="line"># Set backend pipeline buffer size.</div><div class="line">backend_max_pipeline = 1024</div><div class="line"></div><div class="line"># Set backend never read replica groups, default is false</div><div class="line">backend_primary_only = false</div><div class="line"></div><div class="line"># Set backend parallel connections per server</div><div class="line">backend_primary_parallel = 1</div><div class="line">backend_replica_parallel = 1</div><div class="line"></div><div class="line"># Set backend tcp keepalive period. (0 to disable)</div><div class="line">backend_keepalive_period = "75s"</div><div class="line"></div><div class="line"># If there is no request from client for a long time, the connection will be closed. (0 to disable)</div><div class="line"># Set session recv buffer size &amp; timeout.</div><div class="line">session_recv_bufsize = "128kb"</div><div class="line">session_recv_timeout = "30m"</div><div class="line"></div><div class="line"># Set session send buffer size &amp; timeout.</div><div class="line">session_send_bufsize = "64kb"</div><div class="line">session_send_timeout = "30s"</div><div class="line"></div><div class="line"># Make sure this is higher than the max number of requests for each pipeline request, or your client may be blocked.</div><div class="line"># Set session pipeline buffer size.</div><div class="line">session_max_pipeline = 512</div><div class="line"></div><div class="line"># Set session tcp keepalive period. (0 to disable)</div><div class="line">session_keepalive_period = "75s"</div><div class="line"></div><div class="line"># Set metrics server (such as http://localhost:28000), proxy will report json formatted metrics to specified server in a predefined period.</div><div class="line">metrics_report_server = ""</div><div class="line">metrics_report_period = "1s"</div><div class="line"></div><div class="line"># Set influxdb server (such as http://localhost:8086), proxy will report metrics to influxdb.</div><div class="line">metrics_report_influxdb_server = ""</div><div class="line">metrics_report_influxdb_period = "1s"</div><div class="line">metrics_report_influxdb_username = ""</div><div class="line">metrics_report_influxdb_password = ""</div><div class="line">metrics_report_influxdb_database = ""</div></pre></td></tr></table></figure></p>
<p>product_name 集群名称，参考dashboard 参数说明<br>jodis_addr Jodis 注册zookeeper 地址<br>此处把IP修改一下<br>jodis_addr = “192.168.110.129:2181”</p>
<p>启动codis-proxy</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></td><td class="code"><pre><div class="line">nohup bin/codis-proxy --ncpu=2 --config=proxy.conf --log =proxy.log --log-level=WARN &amp;</div><div class="line"></div><div class="line">[root@zhm1 codis]# cat =proxy.log.2016-12-21</div><div class="line">2016/12/21 11:25:01 main.go:100: [WARN] set ncpu = 2, max-ncpu = 0</div><div class="line">2016/12/21 11:25:01 proxy.go:89: [WARN] [0xc42010e840] create new proxy:</div><div class="line">&#123;</div><div class="line">    "token": "673cc48d563a3614c13a3a294067f0b9",</div><div class="line">    "start_time": "2016-12-21 11:25:01.70765896 +0800 CST",</div><div class="line">    "admin_addr": "192.168.110.129:11080",</div><div class="line">    "proto_type": "tcp4",</div><div class="line">    "proxy_addr": "192.168.110.129:19000",</div><div class="line">    "product_name": "codis-demo",</div><div class="line">    "pid": 67097,</div><div class="line">    "pwd": "/usr/local/codis/src/github.com/CodisLabs/codis",</div><div class="line">    "sys": "Linux zhm1.cn 3.10.0-514.el7.x86_64 #1 SMP Tue Nov 22 16:42:41 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux",</div><div class="line">    "hostname": "zhm1.cn",</div><div class="line">    "datacenter": ""</div><div class="line">&#125;</div><div class="line">2016/12/21 11:25:01 proxy.go:353: [WARN] [0xc42010e840] admin start service on [::]:11080</div><div class="line">2016/12/21 11:25:01 main.go:159: [WARN] create proxy with config</div><div class="line">proto_type = "tcp4"</div><div class="line">proxy_addr = "0.0.0.0:19000"</div><div class="line">admin_addr = "0.0.0.0:11080"</div><div class="line">jodis_name = ""</div><div class="line">jodis_addr = "192.168.110.129:2181"</div><div class="line">jodis_timeout = "20s"</div><div class="line">jodis_compatible = false</div><div class="line">product_name = "codis-demo"</div><div class="line">product_auth = ""</div><div class="line">proxy_datacenter = ""</div><div class="line">proxy_max_clients = 1000</div><div class="line">proxy_max_offheap_size = "1gb"</div><div class="line">proxy_heap_placeholder = "256mb"</div><div class="line">backend_ping_period = "5s"</div><div class="line">backend_recv_bufsize = "128kb"</div><div class="line">backend_recv_timeout = "30s"</div><div class="line">backend_send_bufsize = "128kb"</div><div class="line">backend_send_timeout = "30s"</div><div class="line">backend_max_pipeline = 1024</div><div class="line">backend_primary_only = false</div><div class="line">backend_primary_parallel = 1</div><div class="line">backend_replica_parallel = 1</div><div class="line">backend_keepalive_period = "75s"</div><div class="line">session_recv_bufsize = "128kb"</div><div class="line">session_recv_timeout = "30m"</div><div class="line">session_send_bufsize = "64kb"</div><div class="line">session_send_timeout = "30s"</div><div class="line">session_max_pipeline = 512</div><div class="line">session_keepalive_period = "75s"</div><div class="line">metrics_report_server = ""</div><div class="line">metrics_report_period = "1s"</div><div class="line">metrics_report_influxdb_server = ""</div><div class="line">metrics_report_influxdb_period = "1s"</div><div class="line">metrics_report_influxdb_username = ""</div><div class="line">metrics_report_influxdb_password = ""</div><div class="line">metrics_report_influxdb_database = ""</div><div class="line">2016/12/21 11:25:01 main.go:180: [WARN] [0xc42010e840] proxy waiting online ...</div><div class="line">2016/12/21 11:25:01 proxy.go:377: [WARN] [0xc42010e840] proxy start service on 0.0.0.0:19000</div><div class="line">2016/12/21 11:25:02 main.go:180: [WARN] [0xc42010e840] proxy waiting online ...</div></pre></td></tr></table></figure>
<p>codis-proxy 启动后，处于waiting 状态，监听proxy_addr 地址，但是不会accept 连接，添加到集群并完成集群状态的同步，才能改变状态为online。</p>
<p>添加codis-proxy 到集群<br>添加的方法有以下两种：<br>通过codis-fe 添加，通过Add Proxy 按钮，将admin_addr 加入到集群中；<br>通过codis-admin 命令行工具添加：<br>./bin/codis-admin –dashboard=192.168.110.129:18080 –create-proxy -x 192.168.110.129:11080</p>
<p>查看zookeeper 存储的数据<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">zkCli.sh</div><div class="line">[zk: localhost:<span class="number">2181</span>(CONNECTED) <span class="number">0</span>] ls /</div><div class="line">[codis3, zookeeper, kafka]</div><div class="line">[zk: localhost:<span class="number">2181</span>(CONNECTED) <span class="number">1</span>] ls /codis3</div><div class="line">[codis-demo]</div><div class="line">[zk: localhost:<span class="number">2181</span>(CONNECTED) <span class="number">2</span>] ls /codis3/codis-demo</div><div class="line">[proxy, topom]</div><div class="line">[zk: localhost:<span class="number">2181</span>(CONNECTED) <span class="number">3</span>] ls /codis3/codis-demo/proxy</div><div class="line">[proxy<span class="number">-673</span>cc48d563a3614c13a3a294067f0b9]</div><div class="line">[zk: localhost:<span class="number">2181</span>(CONNECTED) <span class="number">4</span>] ls /codis3/codis-demo/topom</div><div class="line">[]</div></pre></td></tr></table></figure></p>
<p><img src="http://oh6ybr0jg.bkt.clouddn.com/zk-codis.jpg" alt="zk-codis"></p>
<p>配置启动Cdis FE 集群管理界面<br>创建conf 目录，放下面生成的codis.json 文件<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">mkdir conf</div><div class="line">./bin/codis-admin --dashboard-list --zookeeper=<span class="number">192.168</span><span class="number">.110</span><span class="number">.129</span> | tee conf/codis.json</div><div class="line"><span class="number">2016</span>/<span class="number">12</span>/<span class="number">21</span> <span class="number">11</span>:<span class="number">32</span>:<span class="number">15</span> zkclient.go:<span class="number">23</span>: [INFO] zookeeper - zkclient setup <span class="keyword">new</span> connection to <span class="number">192.168</span><span class="number">.110</span><span class="number">.129</span></div><div class="line"><span class="number">2016</span>/<span class="number">12</span>/<span class="number">21</span> <span class="number">11</span>:<span class="number">32</span>:<span class="number">15</span> zkclient.go:<span class="number">23</span>: [INFO] zookeeper - Connected to <span class="number">192.168</span><span class="number">.110</span><span class="number">.129</span>:<span class="number">2181</span></div><div class="line"><span class="number">2016</span>/<span class="number">12</span>/<span class="number">21</span> <span class="number">11</span>:<span class="number">32</span>:<span class="number">15</span> zkclient.go:<span class="number">23</span>: [INFO] zookeeper - Authenticated: id=<span class="number">25085718467510274</span>, timeout=<span class="number">40000</span></div><div class="line">[</div><div class="line">    &#123;</div><div class="line">        <span class="string">"name"</span>: <span class="string">"codis-demo"</span>,</div><div class="line">        <span class="string">"dashboard"</span>: <span class="string">"192.168.110.129:18080"</span></div><div class="line">    &#125;</div><div class="line">]</div><div class="line"><span class="number">2016</span>/<span class="number">12</span>/<span class="number">21</span> <span class="number">11</span>:<span class="number">32</span>:<span class="number">15</span> zkclient.go:<span class="number">23</span>: [INFO] zookeeper - Recv loop terminated: err=EOF</div><div class="line"><span class="number">2016</span>/<span class="number">12</span>/<span class="number">21</span> <span class="number">11</span>:<span class="number">32</span>:<span class="number">15</span> zkclient.go:<span class="number">23</span>: [INFO] zookeeper - Send loop terminated: err=&lt;nil&gt;</div></pre></td></tr></table></figure></p>
<p>启动codis-fe<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">./bin/codis-fe --ncpu=2 --log=fe.log --log-level=WARN --dashboard-list=conf/codis.json --listen=192.168.110.129:18090 &amp;</div><div class="line">[3] 67271</div><div class="line">[root@zhm1 codis]# cat fe.log.2016-12-21 </div><div class="line">2016/12/21 11:33:34 main.go:102: [WARN] set ncpu = 2</div><div class="line">2016/12/21 11:33:34 main.go:105: [WARN] set listen = 192.168.110.129:18090</div><div class="line">2016/12/21 11:33:34 main.go:117: [WARN] set assets = /usr/local/codis/src/github.com/CodisLabs/codis/bin/assets</div><div class="line">2016/12/21 11:33:34 main.go:132: [WARN] set --dashboard-list = conf/codis.json</div></pre></td></tr></table></figure></p>
<p>至此codis 的图形界面已经能够显示。<br>打开浏览器访问<a href="http://192.168.110.129:18090/，通过管理界面操作codis" target="_blank" rel="external">http://192.168.110.129:18090/，通过管理界面操作codis</a></p>
<p>如果是机器外访问需要关闭防火墙<br>centos7的命令是<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[root@zhm1 codis]# systemctl stop firewalld.service</div><div class="line">[root@zhm1 codis]# systemctl disable firewalld.service</div><div class="line">Removed symlink /etc/systemd/system/dbus-org.fedoraproject.FirewallD1.service.</div><div class="line">Removed symlink /etc/systemd/system/basic.target.wants/firewalld.service.</div></pre></td></tr></table></figure></p>
<p><img src="http://oh6ybr0jg.bkt.clouddn.com/codis-demo-web.jpg" alt="codis-web1"><br><img src="http://oh6ybr0jg.bkt.clouddn.com/codis-demo-web2.jpg" alt="codis-web2"><br><img src="http://oh6ybr0jg.bkt.clouddn.com/codis-demo-web3.jpg" alt="codis-web3"></p>
<p>创建组和实例<br>操作步骤：<br>在New Group 后面输入1（表示增加编号为1 的组），点击New Group 完成组的创建；<br>然后，Add Server，后面设置ip 和端口，并指向组编号1，点击Add Server 完成redis 实例的创建；</p>
<p><img src="http://oh6ybr0jg.bkt.clouddn.com/codis-group1.jpg" alt="codis-group1"></p>
<p>添加第2 个组，以及第2 个组的实例，操作步骤同上。</p>
<p><img src="http://oh6ybr0jg.bkt.clouddn.com/codis-group2.jpg" alt="codis-group2"></p>
<p>对slot 进行分组<br>输入slot范围和组</p>
<p><img src="http://oh6ybr0jg.bkt.clouddn.com/migrate-slots1.jpg" alt="migrate-slots1.jpg"><br><img src="http://oh6ybr0jg.bkt.clouddn.com/migrate-slots2.jpg" alt="migrate-slots2.jpg"><br><img src="http://oh6ybr0jg.bkt.clouddn.com/migrate-slots3.jpg" alt="migrate-slots3.jpg"><br><img src="http://oh6ybr0jg.bkt.clouddn.com/migrate-slots4.jpg" alt="migrate-slots4.jpg"><br><img src="http://oh6ybr0jg.bkt.clouddn.com/migrate-slots5.jpg" alt="migrate-slots5.jpg"></p>
<p>另外分享一个github上的好文<br>docker玩codis集群<br><a href="https://github.com/ruo91/docker-codis" target="_blank" rel="external">https://github.com/ruo91/docker-codis</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/12/01/RegionServer/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="张洪铭">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Hexo">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Hexo" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/12/01/RegionServer/" itemprop="url">
                  Hbase region处理
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-12-01T23:33:30+08:00">
                2016-12-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/大数据/" itemprop="url" rel="index">
                    <span itemprop="name">大数据</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2016/12/01/RegionServer/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/12/01/RegionServer/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h3 id="减少RegionServer"><a href="#减少RegionServer" class="headerlink" title="减少RegionServer"></a>减少RegionServer</h3><p>节点退役：在制定节点上运行，停止的节点上的RegionServer<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./bin/hbase-daemon.sh stop regionserver</div></pre></td></tr></table></figure></p>
<p>如果在关闭时Hbase存在正在运行的负载均衡，那么Maser针对Region的恢复操作和负载均衡之前可能会产生竞争，尤其是在生产环境中，碰到的几率更大，所以建议现金用负载均衡</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">./hbase shell</div><div class="line">./hbase(main):<span class="number">001</span>:<span class="number">0</span>&gt;blance_switch <span class="literal">false</span></div></pre></td></tr></table></figure>
<h3 id="滚动重启"><a href="#滚动重启" class="headerlink" title="滚动重启"></a>滚动重启</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./bin/graceful_stop slave2</div></pre></td></tr></table></figure>
<p>如果同时退役多个节点，为了防止正在退役的节点把region move到即将退役的节点上可以利用zookeeper，在<br>Hbase_root/training znode中创建要退役的RegionServer的entry</p>
<p>滚动重启三种方式：<br>使用rolling-restart.sh脚本<br>手工进行滚动重启<br>编写自定义的滚动重启脚本</p>
          <!--noindex-->
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/12/01/RegionServer/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/11/27/docker-install/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="张洪铭">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Hexo">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Hexo" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/11/27/docker-install/" itemprop="url">
                  docker_install
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-11-27T21:33:03+08:00">
                2016-11-27
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/大数据/" itemprop="url" rel="index">
                    <span itemprop="name">大数据</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2016/11/27/docker-install/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/11/27/docker-install/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h4 id="1-增加yum源"><a href="#1-增加yum源" class="headerlink" title="1.增加yum源"></a>1.增加yum源</h4><p>在命令行输入：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">cat &gt;<span class="regexp">/etc/yum</span>.repos.d/docker.repo &lt;&lt;-EOF</div><div class="line">[dockerrepo]</div><div class="line">name=Docker Repository</div><div class="line">baseurl=https:<span class="comment">//yum.dockerproject.org/repo/main/centos/6</span></div><div class="line">enabled=<span class="number">1</span></div><div class="line">gpgcheck=<span class="number">1</span></div><div class="line">gpgkey=https:<span class="comment">//yum.dockerproject.org/gpg</span></div><div class="line">EOF</div></pre></td></tr></table></figure></p>
<p>通过yum加载docker<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">yum install docker-engine</div></pre></td></tr></table></figure></p>
<h4 id="2-禁用selinux"><a href="#2-禁用selinux" class="headerlink" title="2.禁用selinux"></a>2.禁用selinux</h4><p>#####2.1.查看selinux状态</p>
<p>[root@localhost ~]# cat /etc/selinux/config<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"># This file controls the state of SELinux on the system.</div><div class="line"># SELINUX= can take one of these three values:</div><div class="line">#     enforcing - SELinux security policy is enforced.</div><div class="line">#     permissive - SELinux prints warnings instead of enforcing.</div><div class="line">#     disabled - No SELinux policy is loaded.</div><div class="line">SELINUX=enforcing</div><div class="line"># SELINUXTYPE= can take one of these two values:</div><div class="line">#     targeted - Targeted processes are protected,</div><div class="line">#     mls - Multi Level Security protection.</div><div class="line">SELINUXTYPE=targeted</div><div class="line">``` </div><div class="line">2.2.修改该配置文件中将enforcing替换为disabled</div><div class="line"> </div><div class="line">[root@localhost ~]# cat /etc/selinux/config</div><div class="line">```js</div><div class="line"># This file controls the state of SELinux on the system.</div><div class="line"># SELINUX= can take one of these three values:</div><div class="line">#     enforcing - SELinux security policy is enforced.</div><div class="line">#     permissive - SELinux prints warnings instead of enforcing.</div><div class="line">#     disabled - No SELinux policy is loaded.</div><div class="line">SELINUX=disabled</div><div class="line"># SELINUXTYPE= can take one of these two values:</div><div class="line">#     targeted - Targeted processes are protected,</div><div class="line">#     mls - Multi Level Security protection.</div><div class="line">SELINUXTYPE=targeted</div></pre></td></tr></table></figure></p>
<p>2.3.Docker使用非root用户<br>将当前用户加入docker组<br>sudo gpasswd -a ${USER} docker</p>
<p>2.4.然后重启<br>restart</p>
          <!--noindex-->
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/11/27/docker-install/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/11/25/kafka_high_level_api/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="张洪铭">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Hexo">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Hexo" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/11/25/kafka_high_level_api/" itemprop="url">
                  Kafka_high_level_api测试
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-11-25T19:10:33+08:00">
                2016-11-25
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/大数据/" itemprop="url" rel="index">
                    <span itemprop="name">大数据</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2016/11/25/kafka_high_level_api/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/11/25/kafka_high_level_api/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h1 id="1-查看官网API"><a href="#1-查看官网API" class="headerlink" title="1.查看官网API"></a>1.查看官网API</h1><p><a href="http://kafka.apache.org/0101/javadoc/index.html?org/apache/kafka/clients/consumer/KafkaConsumer.html">Kafka API</a></p>
<h3 id="Automatic-Offset-Committing"><a href="#Automatic-Offset-Committing" class="headerlink" title="Automatic Offset Committing"></a>Automatic Offset Committing</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">Properties props = <span class="keyword">new</span> Properties();</div><div class="line">     props.put(<span class="string">"bootstrap.servers"</span>, <span class="string">"localhost:9092"</span>);</div><div class="line">     props.put(<span class="string">"group.id"</span>, <span class="string">"test"</span>);</div><div class="line">     props.put(<span class="string">"enable.auto.commit"</span>, <span class="string">"true"</span>);</div><div class="line">     props.put(<span class="string">"auto.commit.interval.ms"</span>, <span class="string">"1000"</span>);</div><div class="line">     props.put(<span class="string">"key.deserializer"</span>, <span class="string">"org.apache.kafka.common.serialization.StringDeserializer"</span>);</div><div class="line">     props.put(<span class="string">"value.deserializer"</span>, <span class="string">"org.apache.kafka.common.serialization.StringDeserializer"</span>);</div><div class="line">     KafkaConsumer&lt;<span class="built_in">String</span>, <span class="built_in">String</span>&gt; consumer = <span class="keyword">new</span> KafkaConsumer&lt;&gt;(props);</div><div class="line">     consumer.subscribe(Arrays.asList(<span class="string">"foo"</span>, <span class="string">"bar"</span>));</div><div class="line">     <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</div><div class="line">         ConsumerRecords&lt;<span class="built_in">String</span>, <span class="built_in">String</span>&gt; records = consumer.poll(<span class="number">100</span>);</div><div class="line">         <span class="keyword">for</span> (ConsumerRecord&lt;<span class="built_in">String</span>, <span class="built_in">String</span>&gt; record : records)</div><div class="line">             System.out.printf(<span class="string">"offset = %d, key = %s, value = %s%n"</span>, record.offset(), record.key(), record.value());</div><div class="line">     &#125;</div></pre></td></tr></table></figure>
<h3 id="Manual-Offset-Control"><a href="#Manual-Offset-Control" class="headerlink" title="Manual Offset Control"></a>Manual Offset Control</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">Properties props = <span class="keyword">new</span> Properties();</div><div class="line">     props.put(<span class="string">"bootstrap.servers"</span>, <span class="string">"localhost:9092"</span>);</div><div class="line">     props.put(<span class="string">"group.id"</span>, <span class="string">"test"</span>);</div><div class="line">     props.put(<span class="string">"enable.auto.commit"</span>, <span class="string">"false"</span>);</div><div class="line">     props.put(<span class="string">"key.deserializer"</span>, <span class="string">"org.apache.kafka.common.serialization.StringDeserializer"</span>);</div><div class="line">     props.put(<span class="string">"value.deserializer"</span>, <span class="string">"org.apache.kafka.common.serialization.StringDeserializer"</span>);</div><div class="line">     KafkaConsumer&lt;<span class="built_in">String</span>, <span class="built_in">String</span>&gt; consumer = <span class="keyword">new</span> KafkaConsumer&lt;&gt;(props);</div><div class="line">     consumer.subscribe(Arrays.asList(<span class="string">"foo"</span>, <span class="string">"bar"</span>));</div><div class="line">     final int minBatchSize = <span class="number">200</span>;</div><div class="line">     List&lt;ConsumerRecord&lt;<span class="built_in">String</span>, <span class="built_in">String</span>&gt;&gt; buffer = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">     <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</div><div class="line">         ConsumerRecords&lt;<span class="built_in">String</span>, <span class="built_in">String</span>&gt; records = consumer.poll(<span class="number">100</span>);</div><div class="line">         <span class="keyword">for</span> (ConsumerRecord&lt;<span class="built_in">String</span>, <span class="built_in">String</span>&gt; record : records) &#123;</div><div class="line">             buffer.add(record);</div><div class="line">         &#125;</div><div class="line">         <span class="keyword">if</span> (buffer.size() &gt;= minBatchSize) &#123;</div><div class="line">             insertIntoDb(buffer);</div><div class="line">             consumer.commitSync();</div><div class="line">             buffer.clear();</div><div class="line">         &#125;</div><div class="line">     &#125;</div></pre></td></tr></table></figure>
          <!--noindex-->
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/11/25/kafka_high_level_api/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/01/27/storm基础知识/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="张洪铭">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Hexo">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Hexo" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/01/27/storm基础知识/" itemprop="url">
                  storm基础知识
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-01-27T20:00:00+08:00">
                2016-01-27
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/storm/" itemprop="url" rel="index">
                    <span itemprop="name">storm</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2016/01/27/storm基础知识/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/01/27/storm基础知识/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Storm是一个分布式计算框架，主要由Clojure编程语言编写。最初是由Nathan Marz及其团队创建于BackType，该项目在被Twitter取得后开源。它使用用户创建的“管（spouts）”和“螺栓（bolts）”来定义信息源和操作来允许批量、分布式处理流式数据。最初的版本发布于2011年9月17日。<br>Storm应用被设计成为一个拓扑结构，其接口创建一个转换“流”。它提供与MapReduce作业类似的功能，当遇到异常时该拓扑结构理论上将不确定地运行，直到它被手动终止<br><img src="http://storm.apache.org/images/storm-flow.png" alt="此处输入图片的描述"><br>主要版本</p>
<table>
<thead>
<tr>
<th>版本</th>
<th>发布日期</th>
</tr>
</thead>
<tbody>
<tr>
<td>0.9.0.1</td>
<td>2013年12月8日</td>
</tr>
<tr>
<td>0.9.0</td>
<td>2013年12月8日</td>
</tr>
<tr>
<td>0.8.0</td>
<td>2012年8月2日</td>
</tr>
<tr>
<td>0.7.0</td>
<td>2012年2月28日</td>
</tr>
<tr>
<td>0.6.0</td>
<td>2011年12月15日</td>
</tr>
<tr>
<td>0.5.0</td>
<td>2011年9月19日</td>
</tr>
</tbody>
</table>
<h2 id="编程模型"><a href="#编程模型" class="headerlink" title="编程模型"></a>编程模型</h2><p>###Topology<br>一个实时计算应用程序逻辑被封装在Topology对象中， 类似Hadoop中的job， Topology会一直运行直到你显式杀死它</p>
<p>###DataSource<br>外部数据源</p>
<p>###Spout<br>接受外部数据源的组件，将外部数据源转化成Storm内部的数据，以Tuple为基本的传输单元下发给Bolt</p>
<p>###Bolt<br>接受Spout发送的数据，或上游的bolt的发送的数据。根据业务逻辑进行处理。发送给下一个Bolt或者是存储到某种介质上。介质可以是Redis可以是mysql，或者其他。</p>
<p>###Tuple<br>Storm内部中数据传输的基本单元，里面封装了一个List对象，用来保存数据。</p>
<p>##StreamGrouping:</p>
<p>####数据分组策略7种：<br>shuffleGrouping(Random函数),<br>NonGrouping(Random函数,目前和shuffleGrouping一样),<br>FieldGrouping(Hash取模),<br>Local or ShuffleGrouping （本地或随机，优先本地）,<br>Fields grouping（根据Tuple中的某一个Filed或者多个Filed的是值来划分。 比如<br>Stream根据Field为user-id来grouping， 相同user-id值的Tuple会被分<br>发到相同的Task中）,<br>Global grouping（整个Stream会选择一个Task作为分发的目的地， 通常是最新的那<br>个id的Task）<br>Direct grouping（产生数据的Spout/Bolt自己明确决定这个Tuple被Bolt的那些Task所<br>消费）</p>
<h2 id="Storm优点"><a href="#Storm优点" class="headerlink" title="Storm优点"></a>Storm优点</h2><h4 id="健壮性"><a href="#健壮性" class="headerlink" title="健壮性"></a>健壮性</h4><p>当Worker失效或机器出现故障时， 自动分配新的Worker替换失<br>效Worker</p>
<h4 id="准确性"><a href="#准确性" class="headerlink" title="准确性"></a>准确性</h4><p>采用Acker机制，保证数据不丢失<br>采用事务机制，保证数据准确性</p>
<h2 id="storm架构"><a href="#storm架构" class="headerlink" title="storm架构"></a>storm架构</h2><p><img src="http://oh6ybr0jg.bkt.clouddn.com/storm%E6%9E%B6%E6%9E%84.png" alt="此处输入图片的描述"></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-原理 " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/03/03/CAP原理/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="张洪铭">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Hexo">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Hexo" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/03/03/CAP原理/" itemprop="url">
                  CAP原理
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-03-03T21:31:10+08:00">
                2015-03-03
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/原理/" itemprop="url" rel="index">
                    <span itemprop="name">原理</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2015/03/03/CAP原理/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2015/03/03/CAP原理/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Consistency 一致性<br>Ø 通过某个节点的写操作结果对后面通过其它节点的读操作可见<br>Ø 如果更新数据后，并发访问情况下可立即感知该更新，称为强一致性<br>Ø 如果允许之后部分或者全部感知不到该更新，称为弱一致性<br>Ø 若在之后的一段时间（通常该时间不固定）后，一定可以感知该更新，称为最终一致性<br>Availability  可用性<br>Ø 任何一个没有发生故障的节点必须在有限的时间内返回合理的结果<br>Partition tolerance  分区容忍性<br>Ø 部分节点宕机或者无法与其它节点通信时，各分区间还可保持分布式系统的功能</p>
<p>结论：<br>分布式存储系统中，一致性，可用性，分区容忍性只能满足两个，不能满足三个。<br>由于当前的网络硬件肯定会出现延迟丢包等问题，所以分区容忍性是我们必须需要实现的。因此很多时候是在可用性和一致性之间权衡。。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-jdk " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2014/12/04/jdk8-Optional/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="张洪铭">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Hexo">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Hexo" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/12/04/jdk8-Optional/" itemprop="url">
                  jdk8 Optional
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2014-12-04T10:22:30+08:00">
                2014-12-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index">
                    <span itemprop="name">java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2014/12/04/jdk8-Optional/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014/12/04/jdk8-Optional/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="java-8-Optional"><a href="#java-8-Optional" class="headerlink" title="java 8 Optional"></a>java 8 Optional</h3><p>1.of方法：<br>为非null的值创建一个Optional。</p>
<p>of方法通过工厂方法创建Optional类。需要注意的是，创建对象时传入的参数不能为null。如果传入参数为null，则抛出NullPointerException 。</p>
<p>//调用工厂方法创建Optional实例<br>Optional<string> name = Optional.of(“Sanaulla”);//ok<br>//传入参数为null，抛出NullPointerException.<br>Optional<string> someNull = Optional.of(null);//java.lang.NullPointerException</string></string></p>
<p>ofNullable<br>为指定的值创建一个Optional，如果指定的值为null，则返回一个空的Optional。</p>
<p>ofNullable与of方法相似，唯一的区别是可以接受参数为null的情况。示例如下：</p>
<p>Optional empty = Optional.ofNullable(null);</p>
<p>isPresent<br>如果值存在返回true，否则返回false。</p>
<p>Optional name = Optional.of(“name”);<br>Optional name2 = Optional.ofNullable(null);<br>if (name.isPresent()) {<br>  //在Optional实例内调用get()返回已存在的值<br>  System.out.println(name.get());//输出Sanaulla<br>}</p>
<p>orElse<br>如果有值则将其返回，否则返回指定的其它值。</p>
<p>Optional name = Optional.ofNullable(null);<br>System.out.println(name.orElse(“There is some value!”));</p>
<p>orElseGet<br>orElseGet与orElse方法类似，区别在于得到的默认值。orElse方法将传入的字符串作为默认</p>
<p>System.out.println(name.orElseGet(() -&gt; “Default Value”));</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-jdk " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2014/12/03/jdk8-引用方法/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="张洪铭">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Hexo">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Hexo" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/12/03/jdk8-引用方法/" itemprop="url">
                  jdk8 引用方法
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2014-12-03T11:13:00+08:00">
                2014-12-03
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index">
                    <span itemprop="name">java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2014/12/03/jdk8-引用方法/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014/12/03/jdk8-引用方法/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="java-8-引用方法"><a href="#java-8-引用方法" class="headerlink" title="java 8 引用方法"></a>java 8 引用方法</h3><p>我们通常使用lambda表达式来创建匿名方法。然而，有时候我们仅仅是调用了一个已存在的方法。如下:</p>
<p>Arrays.sort(stringsArray,(s1,s2)-&gt;s1.compareToIgnoreCase(s2));</p>
<p>在Java8中，我们可以直接通过方法引用来简写lambda表达式中已经存在的方法。</p>
<p>Arrays.sort(stringsArray, String::compareToIgnoreCase);</p>
<p>Person [] persons = new Person[10];</p>
<p>//使用匿名类<br>Arrays.sort(persons, new Comparator<person>() {<br>            @Override<br>            public int compare(Person o1, Person o2) {<br>                return o1.birthday.compareTo(o2.birthday);<br>            }<br> });</person></p>
<p>//使用lambda表达式<br>Arrays.sort(persons, (o1, o2) -&gt; o1.birthday.compareTo(o2.birthday));</p>
<p>//使用lambda表达式和类的静态方法<br>Arrays.sort(persons, (o1, o2) -&gt; Person.compareByAge(o1,o2));</p>
<p>//使用方法引用<br>//引用的是类的静态方法<br>Arrays.sort(persons, Person::compareByAge);</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2014/12/02/jdk8-enum/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="张洪铭">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Hexo">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Hexo" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/12/02/jdk8-enum/" itemprop="url">
                  解密JDK8 枚举
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2014-12-02T12:33:30+08:00">
                2014-12-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index">
                    <span itemprop="name">java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2014/12/02/jdk8-enum/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014/12/02/jdk8-enum/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="写一个枚举类"><a href="#写一个枚举类" class="headerlink" title="写一个枚举类"></a>写一个枚举类</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">public enum Season &#123;</div><div class="line">	SPRING,</div><div class="line">    SUMMER,</div><div class="line">    AUTUMN,</div><div class="line">    WINTER</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="然后我们使用javac编译上面的类-得到class文件"><a href="#然后我们使用javac编译上面的类-得到class文件" class="headerlink" title="然后我们使用javac编译上面的类,得到class文件"></a>然后我们使用javac编译上面的类,得到class文件</h3><h3 id="然后-我们利用反编译的方法来看看字节码文件究竟是什么-这里使用的工具是javap的简单命令-先列举一下这个Season下的全部元素"><a href="#然后-我们利用反编译的方法来看看字节码文件究竟是什么-这里使用的工具是javap的简单命令-先列举一下这个Season下的全部元素" class="headerlink" title="然后,我们利用反编译的方法来看看字节码文件究竟是什么.这里使用的工具是javap的简单命令,先列举一下这个Season下的全部元素."></a>然后,我们利用反编译的方法来看看字节码文件究竟是什么.这里使用的工具是javap的简单命令,先列举一下这个Season下的全部元素.</h3><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div></pre></td><td class="code"><pre><div class="line">Classfile /C:/Season.class</div><div class="line">  Last modified 2016-12-8; size 956 bytes</div><div class="line">  MD5 checksum 7f6dfb988d182327a1a73ee986a9d3fa</div><div class="line">  Compiled from "Season.java"</div><div class="line">public final class cn.redis.model.Season extends java.lang.Enum&lt;cn.redis.model.S</div><div class="line">eason&gt;</div><div class="line">  minor version: 0</div><div class="line">  major version: 52</div><div class="line">  flags: ACC_PUBLIC, ACC_FINAL, ACC_SUPER, ACC_ENUM</div><div class="line">Constant pool:</div><div class="line">   #1 = Fieldref           #4.#38         // cn/redis/model/Season.$VALUES:[Lcn/</div><div class="line">redis/model/Season;</div><div class="line">   #2 = Methodref          #39.#40        // "[Lcn/redis/model/Season;".clone:()</div><div class="line">Ljava/lang/Object;</div><div class="line">   #3 = Class              #23            // "[Lcn/redis/model/Season;"</div><div class="line">   #4 = Class              #41            // cn/redis/model/Season</div><div class="line">   #5 = Methodref          #16.#42        // java/lang/Enum.valueOf:(Ljava/lang/</div><div class="line">Class;Ljava/lang/String;)Ljava/lang/Enum;</div><div class="line">   #6 = Methodref          #16.#43        // java/lang/Enum."&lt;init&gt;":(Ljava/lang</div><div class="line">/String;I)V</div><div class="line">   #7 = String             #17            // SPRING</div><div class="line">   #8 = Methodref          #4.#43         // cn/redis/model/Season."&lt;init&gt;":(Lja</div><div class="line">va/lang/String;I)V</div><div class="line">   #9 = Fieldref           #4.#44         // cn/redis/model/Season.SPRING:Lcn/re</div><div class="line">dis/model/Season;</div><div class="line">  #10 = String             #19            // SUMMER</div><div class="line">  #11 = Fieldref           #4.#45         // cn/redis/model/Season.SUMMER:Lcn/re</div><div class="line">dis/model/Season;</div><div class="line">  #12 = String             #20            // AUTUMN</div><div class="line">  #13 = Fieldref           #4.#46         // cn/redis/model/Season.AUTUMN:Lcn/re</div><div class="line">dis/model/Season;</div><div class="line">  #14 = String             #21            // WINTER</div><div class="line">  #15 = Fieldref           #4.#47         // cn/redis/model/Season.WINTER:Lcn/re</div><div class="line">dis/model/Season;</div><div class="line">  #16 = Class              #48            // java/lang/Enum</div><div class="line">  #17 = Utf8               SPRING</div><div class="line">  #18 = Utf8               Lcn/redis/model/Season;</div><div class="line">  #19 = Utf8               SUMMER</div><div class="line">  #20 = Utf8               AUTUMN</div><div class="line">  #21 = Utf8               WINTER</div><div class="line">  #22 = Utf8               $VALUES</div><div class="line">  #23 = Utf8               [Lcn/redis/model/Season;</div><div class="line">    #24 = Utf8               values</div><div class="line">  #25 = Utf8               ()[Lcn/redis/model/Season;</div><div class="line">  #26 = Utf8               Code</div><div class="line">  #27 = Utf8               LineNumberTable</div><div class="line">  #28 = Utf8               valueOf</div><div class="line">  #29 = Utf8               (Ljava/lang/String;)Lcn/redis/model/Season;</div><div class="line">  #30 = Utf8               &lt;init&gt;</div><div class="line">  #31 = Utf8               (Ljava/lang/String;I)V</div><div class="line">  #32 = Utf8               Signature</div><div class="line">  #33 = Utf8               ()V</div><div class="line">  #34 = Utf8               &lt;clinit&gt;</div><div class="line">  #35 = Utf8               Ljava/lang/Enum&lt;Lcn/redis/model/Season;&gt;;</div><div class="line">  #36 = Utf8               SourceFile</div><div class="line">  #37 = Utf8               Season.java</div><div class="line">  #38 = NameAndType        #22:#23        // $VALUES:[Lcn/redis/model/Season;</div><div class="line">  #39 = Class              #23            // "[Lcn/redis/model/Season;"</div><div class="line">  #40 = NameAndType        #49:#50        // clone:()Ljava/lang/Object;</div><div class="line">  #41 = Utf8               cn/redis/model/Season</div><div class="line">  #42 = NameAndType        #28:#51        // valueOf:(Ljava/lang/Class;Ljava/lan</div><div class="line">g/String;)Ljava/lang/Enum;</div><div class="line">  #43 = NameAndType        #30:#31        // "&lt;init&gt;":(Ljava/lang/String;I)V</div><div class="line">  #44 = NameAndType        #17:#18        // SPRING:Lcn/redis/model/Season;</div><div class="line">  #45 = NameAndType        #19:#18        // SUMMER:Lcn/redis/model/Season;</div><div class="line">  #46 = NameAndType        #20:#18        // AUTUMN:Lcn/redis/model/Season;</div><div class="line">    #47 = NameAndType        #21:#18        // WINTER:Lcn/redis/model/Season;</div><div class="line">  #48 = Utf8               java/lang/Enum</div><div class="line">  #49 = Utf8               clone</div><div class="line">  #50 = Utf8               ()Ljava/lang/Object;</div><div class="line">  #51 = Utf8               (Ljava/lang/Class;Ljava/lang/String;)Ljava/lang/Enum;</div><div class="line"></div><div class="line">&#123;</div><div class="line">  public static final cn.redis.model.Season SPRING;</div><div class="line">    descriptor: Lcn/redis/model/Season;</div><div class="line">    flags: ACC_PUBLIC, ACC_STATIC, ACC_FINAL, ACC_ENUM</div><div class="line"></div><div class="line">  public static final cn.redis.model.Season SUMMER;</div><div class="line">    descriptor: Lcn/redis/model/Season;</div><div class="line">    flags: ACC_PUBLIC, ACC_STATIC, ACC_FINAL, ACC_ENUM</div><div class="line"></div><div class="line">  public static final cn.redis.model.Season AUTUMN;</div><div class="line">    descriptor: Lcn/redis/model/Season;</div><div class="line">    flags: ACC_PUBLIC, ACC_STATIC, ACC_FINAL, ACC_ENUM</div><div class="line"></div><div class="line">  public static final cn.redis.model.Season WINTER;</div><div class="line">    descriptor: Lcn/redis/model/Season;</div><div class="line">    flags: ACC_PUBLIC, ACC_STATIC, ACC_FINAL, ACC_ENUM</div><div class="line"></div><div class="line">  public static cn.redis.model.Season[] values();</div><div class="line">      descriptor: ()[Lcn/redis/model/Season;</div><div class="line">    flags: ACC_PUBLIC, ACC_STATIC</div><div class="line">    Code:</div><div class="line">      stack=1, locals=0, args_size=0</div><div class="line">         0: getstatic     #1                  // Field $VALUES:[Lcn/redis/model/</div><div class="line">Season;</div><div class="line">         3: invokevirtual #2                  // Method "[Lcn/redis/model/Season</div><div class="line">;".clone:()Ljava/lang/Object;</div><div class="line">         6: checkcast     #3                  // class "[Lcn/redis/model/Season;</div><div class="line">"</div><div class="line">         9: areturn</div><div class="line">      LineNumberTable:</div><div class="line">        line 3: 0</div><div class="line"></div><div class="line">  public static cn.redis.model.Season valueOf(java.lang.String);</div><div class="line">    descriptor: (Ljava/lang/String;)Lcn/redis/model/Season;</div><div class="line">    flags: ACC_PUBLIC, ACC_STATIC</div><div class="line">    Code:</div><div class="line">      stack=2, locals=1, args_size=1</div><div class="line">         0: ldc           #4                  // class cn/redis/model/Season</div><div class="line">         2: aload_0</div><div class="line">         3: invokestatic  #5                  // Method java/lang/Enum.valueOf:(</div><div class="line">Ljava/lang/Class;Ljava/lang/String;)Ljava/lang/Enum;</div><div class="line">         6: checkcast     #4                  // class cn/redis/model/Season</div><div class="line">                  9: areturn</div><div class="line">      LineNumberTable:</div><div class="line">        line 3: 0</div><div class="line"></div><div class="line">  static &#123;&#125;;</div><div class="line">    descriptor: ()V</div><div class="line">    flags: ACC_STATIC</div><div class="line">    Code:</div><div class="line">      stack=4, locals=0, args_size=0</div><div class="line">         0: new           #4                  // class cn/redis/model/Season</div><div class="line">         3: dup</div><div class="line">         4: ldc           #7                  // String SPRING</div><div class="line">         6: iconst_0</div><div class="line">         7: invokespecial #8                  // Method "&lt;init&gt;":(Ljava/lang/Str</div><div class="line">ing;I)V</div><div class="line">        10: putstatic     #9                  // Field SPRING:Lcn/redis/model/Se</div><div class="line">ason;</div><div class="line">        13: new           #4                  // class cn/redis/model/Season</div><div class="line">        16: dup</div><div class="line">        17: ldc           #10                 // String SUMMER</div><div class="line">        19: iconst_1</div><div class="line">        20: invokespecial #8                  // Method "&lt;init&gt;":(Ljava/lang/Str</div><div class="line">ing;I)V</div><div class="line">        23: putstatic     #11                 // Field SUMMER:Lcn/redis/model/Se</div><div class="line">        ason;</div><div class="line">        26: new           #4                  // class cn/redis/model/Season</div><div class="line">        29: dup</div><div class="line">        30: ldc           #12                 // String AUTUMN</div><div class="line">        32: iconst_2</div><div class="line">        33: invokespecial #8                  // Method "&lt;init&gt;":(Ljava/lang/Str</div><div class="line">ing;I)V</div><div class="line">        36: putstatic     #13                 // Field AUTUMN:Lcn/redis/model/Se</div><div class="line">ason;</div><div class="line">        39: new           #4                  // class cn/redis/model/Season</div><div class="line">        42: dup</div><div class="line">        43: ldc           #14                 // String WINTER</div><div class="line">        45: iconst_3</div><div class="line">        46: invokespecial #8                  // Method "&lt;init&gt;":(Ljava/lang/Str</div><div class="line">ing;I)V</div><div class="line">        49: putstatic     #15                 // Field WINTER:Lcn/redis/model/Se</div><div class="line">ason;</div><div class="line">        52: iconst_4</div><div class="line">        53: anewarray     #4                  // class cn/redis/model/Season</div><div class="line">        56: dup</div><div class="line">        57: iconst_0</div><div class="line">        58: getstatic     #9                  // Field SPRING:Lcn/redis/model/Se</div><div class="line">ason;</div><div class="line">        61: aastore</div><div class="line">                62: dup</div><div class="line">        63: iconst_1</div><div class="line">        64: getstatic     #11                 // Field SUMMER:Lcn/redis/model/Se</div><div class="line">ason;</div><div class="line">        67: aastore</div><div class="line">        68: dup</div><div class="line">        69: iconst_2</div><div class="line">        70: getstatic     #13                 // Field AUTUMN:Lcn/redis/model/Se</div><div class="line">ason;</div><div class="line">        73: aastore</div><div class="line">        74: dup</div><div class="line">        75: iconst_3</div><div class="line">        76: getstatic     #15                 // Field WINTER:Lcn/redis/model/Se</div><div class="line">ason;</div><div class="line">        79: aastore</div><div class="line">        80: putstatic     #1                  // Field $VALUES:[Lcn/redis/model/</div><div class="line">Season;</div><div class="line">        83: return</div><div class="line">      LineNumberTable:</div><div class="line">        line 4: 0</div><div class="line">        line 5: 13</div><div class="line">        line 6: 26</div><div class="line">        line 7: 39</div><div class="line">        line 3: 52</div><div class="line">        &#125;</div><div class="line">Signature: #35                          // Ljava/lang/Enum&lt;Lcn/redis/model/Seaso</div><div class="line">n;&gt;;</div><div class="line">SourceFile: "Season.java"</div></pre></td></tr></table></figure>
<h3 id="从上反编译结果可知"><a href="#从上反编译结果可知" class="headerlink" title="从上反编译结果可知"></a>从上反编译结果可知</h3><ul>
<li>java代码中的Season转换成了继承自的java.lang.enum的类</li>
<li>既然隐式继承自java.lang.enum,也就意味java代码中,Season不能再继承其他的类</li>
<li>Season被标记成了final,意味着它不能被继承</li>
<li>静态块static {};  0~52为实例化SPRING, SUMMER, AUTUMN, WINTER</li>
<li>53~83为创建Season[]数组$VALUES,并将上面的四个对象放入数组的操作.</li>
<li>8: invokevirtual #4 在switch-case中,还是将Enum转成了int值(通过调用Enum.oridinal()方法)</li>
<li></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2014/11/25/hello-world/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="张洪铭">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Hexo">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Hexo" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/11/25/hello-world/" itemprop="url">
                  Hello World
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2014-11-25T19:10:33+08:00">
                2014-11-25
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/����/" itemprop="url" rel="index">
                    <span itemprop="name">����</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2014/11/25/hello-world/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014/11/25/hello-world/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo new <span class="string">"My New Post"</span></div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo server</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo generate</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo deploy</div></pre></td></tr></table></figure>
<p>��ӭ���������ҵĲ���</p>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="张洪铭" />
          <p class="site-author-name" itemprop="name">张洪铭</p>
          <p class="site-description motion-element" itemprop="description">人生在勤 勤则不匮</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">30</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">9</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">7</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">张洪铭</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"zhm8"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    
    <script src="/lib/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  








  
  

  

  

  

  


</body>
</html>
